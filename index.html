<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>

  
  <meta name="author" content="John Doe">
  

  

  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content="Hexo"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">Hexo</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/St">Home</a></li>
      
        <li><a href="/Git">Archives</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    
  <article>

  
    
    <h3 class="article-title"><a href="/2022/02/17/Git/1-开始/"><span></span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/02/17/Git/1-开始/" rel="bookmark">
        <time class="entry-date published" datetime="2022-02-17T07:30:55.965Z">
          2022-02-17
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="大致步骤"><a href="#大致步骤" class="headerlink" title="大致步骤"></a>大致步骤</h1><h2 id="1-自报家门：初始化"><a href="#1-自报家门：初始化" class="headerlink" title="1. 自报家门：初始化"></a>1. 自报家门：初始化</h2><p>使用<code>git config</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ git config --list  </span><br><span class="line">#查看当前的config配置</span><br><span class="line"></span><br><span class="line">$ git config --global user.name &quot;Your Name&quot;</span><br><span class="line">#设置用户名</span><br><span class="line"></span><br><span class="line">$ git config --global user.email &quot;email@example.com&quot;</span><br><span class="line">#设置邮箱</span><br></pre></td></tr></table></figure>
<ul>
<li><code>git config</code>的<code>--global</code>参数：<strong>表示机器上所有的Git仓库都会使用这个配置</strong><br>（也可以对某个仓库指定不同的用户名和Email地址）</li>
</ul>
<h2 id="2-创建版本库"><a href="#2-创建版本库" class="headerlink" title="2. 创建版本库"></a>2. 创建版本库</h2><p>使用<code>git init</code>把当前目录变成git可以管理的仓库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git init</span><br><span class="line">#Initialized empty Git repository in /Users/michael/learngit/.git/</span><br></pre></td></tr></table></figure>
<ul>
<li>这里Linux使用 <code>ls --ah</code> 可以看见git生成的 <code>.git</code> 子目录，<strong>该目录默认隐藏</strong></li>
</ul>
<h2 id="3-添加、提交文件"><a href="#3-添加、提交文件" class="headerlink" title="3. 添加、提交文件"></a>3. 添加、提交文件</h2><p>先使用<code>git add</code>将文件添加至仓库，后使用<code>git commit</code>将文件提交到仓库，<strong>完成</strong></p>
<ul>
<li><code>git add .</code><strong>和</strong><code>git add *</code><strong>的区别</strong>：git add . 会把本地所有untrack的文件都加入暂存区，并且会根据<code>.gitignore</code>做过滤，但是<code>git add *</code> 会忽略<code>.gitignore</code>文件，并把任何文件都加入</li>
<li><strong>为什么先add后commit：</strong><code>git commit</code> 一次可以添加很多文件，所以在<code>git commit</code>之前可以先<code>git add</code>若干文件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ git add file1.txt</span><br><span class="line">$ git add file2.txt file3.txt</span><br><span class="line"></span><br><span class="line">$ git commit -m &quot;wrote a readme file&quot;</span><br><span class="line"></span><br><span class="line">#[master (root-commit) eaadf4e] wrote a readme file</span><br><span class="line">#1 file changed, 2 insertions(+)</span><br><span class="line">#create mode 100644 readme.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>这里<code>-m</code>参数后输入<strong>提交说明</strong></li>
</ul>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2022/02/17/Git/z-杂/"><span></span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/02/17/Git/z-杂/" rel="bookmark">
        <time class="entry-date published" datetime="2022-02-17T07:30:55.934Z">
          2022-02-17
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h3 id="分支工作流"><a href="#分支工作流" class="headerlink" title="分支工作流"></a>分支工作流</h3><h3 id="git规则"><a href="#git规则" class="headerlink" title="git规则"></a><strong>git规则</strong></h3><p>.gitignore只能忽略那些原来没有被track的文件，如果某些文件已经被纳入了版本管理中，则修改.gitignore是无效的</p>
<p><strong>解决办法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git rm -r --cached .</span><br><span class="line">git add .</span><br><span class="line">git commit -m &#x27;update .gitignore&#x27;</span><br></pre></td></tr></table></figure>





<h3 id="工作区-amp-暂存区详解"><a href="#工作区-amp-暂存区详解" class="headerlink" title="工作区&amp;暂存区详解"></a>工作区&amp;暂存区详解</h3><ul>
<li>工作区（Working Directory）：learngit 文件夹就是一个工作区。</li>
<li>版本库（Repository）：工作区有个隐藏目录 .git ，这个不算工作区，而是 Git 的版本库。</li>
<li>版本库里面的 index(stage) 文件叫暂存区，还有Git为我们自动创建的第一个分支 master ，以及指向 master 的一个指针叫做 HEAD。</li>
</ul>
<p><img src="/img%5Cwd-repo-stage.png" alt="image-wd-repo-stage"></p>
<p>如果我们想把文件添加到Git里面时，需要分两步：</p>
<ul>
<li><p>第一步是用 git add 把文件添加进去，实际上就是把文件修改添加到暂存区。</p>
</li>
<li><p>第二步是用 git commit 提交更改，实际上就是把暂存区的所有内容提交到当前分支。（我们现在只有唯一一个分支 master，所以现在就是往 master 分支上提交更改）</p>
</li>
<li><p>图片等二进制文件使用git？</p>
</li>
</ul>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2022/02/17/Git/z-分支工作流/"><span></span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/02/17/Git/z-分支工作流/" rel="bookmark">
        <time class="entry-date published" datetime="2022-02-17T07:30:55.918Z">
          2022-02-17
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>其实最基本的流程就是新建分支，在这个分支上改动代码，再提交上去，跟master分支合并。</p>
<h3 id="新建分支"><a href="#新建分支" class="headerlink" title="新建分支"></a>新建分支</h3><p>首先，在你新建分支之前，你应该在master分支，并且要保证你当前的是最新代码，要不然就是找死，最后提交代码就会出问题。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git pull origin master #，在master分支下，保证当前代码与线上同步，是最新的</span><br><span class="line">git branch &lt;分支名&gt; #，正儿八经的新建分支。</span><br><span class="line">git checkout &lt;分支名&gt; #，切换 到新建的分支上，再进行下一步。</span><br><span class="line">git push origin &lt;分支名&gt; #,把本地分支推到远端，让远端也有一个你的分支，用来后面提交你的代码。</span><br><span class="line">git checkout -b &lt;分支名&gt; #新建分支并切换到该分支：</span><br></pre></td></tr></table></figure>



<h3 id="提交代码"><a href="#提交代码" class="headerlink" title="提交代码"></a>提交代码</h3><p>在新建的分支上写完代码之后，就可以提交代码了。此时应该在你新建的分支上</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git status #,查看自己写了哪些东西。</span><br><span class="line">git add .</span><br><span class="line">git commit -m ‘本次提交的描述（写自己的话，不要抄我的，哼！）’</span><br><span class="line">git push origin &lt;分支名&gt; </span><br><span class="line"><span class="meta">#</span><span class="language-bash">,push是从本地向远端推代码，也就是把自己写的代码提交上去，像给老师交作业一样。</span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">执行完上一步，有可能报错，此时淡定，不认识英语的话在线翻译是干嘛的，大多数时候提示你，本地落后于远端，（意思就是远端比本地多了一些代码，为什么会出现这种情况呢，肯定是你跟别人共用一个分支，他提交了一段代码到远端，所以导致你的本地落后于远端）既然落后了，那就把他更新成最新的呗，</span></span><br><span class="line">git pull --rebase origin #远程分支名</span><br><span class="line"><span class="meta">#</span><span class="language-bash">执行完之后，你的代码就跟远端又一样了。并且你的修改仍然在，此时再提交你的代码</span></span><br><span class="line">git push origin &lt;分支名&gt;</span><br></pre></td></tr></table></figure>



<h3 id="rebase代码"><a href="#rebase代码" class="headerlink" title="rebase代码"></a>rebase代码</h3><p>提交完代码之后需要让测试人员进行测试，若测试没问题，就可以rebase代码，然后上线了。（这一步是保证你要上线的代码是基于最新的master）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git pull —rebase origin &lt;分支名&gt;</span><br><span class="line">git pull —rebase origin master</span><br><span class="line"><span class="meta">#</span><span class="language-bash">执行这两步的时候都有可能发生冲突，此时你要做的就是解决冲突，再继续提交。</span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">解决完冲突之后，git add .</span></span><br><span class="line">git rebase —continue</span><br><span class="line"><span class="meta">#</span><span class="language-bash">若此时还有冲突，继续解决，解决完继续执行1，2步。</span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">若此时没有报错，git push origin &lt;分支名&gt;；（这一步必须在git pull —rebase origin master成功之后执行）</span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">此时若显示，当前分支落后于master分支，则需要强推，git push -f origin &lt;分支名&gt;，若不报错，则rebase成功。</span></span><br></pre></td></tr></table></figure>

<p>以上就是一个完整的流程，以下是一些常用的git操作</p>
<h3 id="删除分支"><a href="#删除分支" class="headerlink" title="删除分支"></a>删除分支</h3><p>删除本地分支 ( <strong>切换到master分支之后再删除</strong> )</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d &lt;分支名&gt;</span><br></pre></td></tr></table></figure>

<p>删除远端分支</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin --delete &lt;分支名&gt;</span><br></pre></td></tr></table></figure>

<p>查看本地有哪些分支</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure>

<h3 id="切换分支"><a href="#切换分支" class="headerlink" title="切换分支"></a>切换分支</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout &lt;分支名&gt;</span><br></pre></td></tr></table></figure>

<h3 id="如何从远程拉一个分支"><a href="#如何从远程拉一个分支" class="headerlink" title="如何从远程拉一个分支"></a>如何从远程拉一个分支</h3><p>当你跟别人共用一个分支的时候（有时候前端会共用一个分支），如果别人新建了一个分支（此时远端应该已经有了你们要用的分支），你要做的就是把远端的分支拉到自己本地。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin &lt;分支名&gt;: &lt;分支名&gt;</span><br></pre></td></tr></table></figure>

<h3 id="合并分支"><a href="#合并分支" class="headerlink" title="合并分支"></a>合并分支</h3><p>如果你基于主分支master新建了分支dev，再基于dev分支新建了一个分支test，在test分支开发完成后，需要将test合并到dev分支上。此时，先用git branch 查看自己在哪个分支上，然后git checkout dev(切换到需要合并的分支上)，最后<code>git merge test</code>（在dev分支上执行这句，意思是将test合并到dev分支上）</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2022/02/17/Git/z-常见忽略/"><span></span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/02/17/Git/z-常见忽略/" rel="bookmark">
        <time class="entry-date published" datetime="2022-02-17T07:30:55.918Z">
          2022-02-17
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">忽略 node_modules 目录</span></span><br><span class="line">/node_modules</span><br><span class="line">/unpackage/dist</span><br></pre></td></tr></table></figure>



<p>node_modules不是你自己的源代码，而是存放你在package.json中指定的依赖的外部库和框架的文件，这些依赖库少的有几百M多的好几G，而且又不你的源代码，其内容已经存储在其他服务器上，没必要放到github，你只要把package.json放上去，别人下载你的package.json，运行个npm install就会自动把node_modules文件夹建立起来，和你自己的node_modules文件夹里面的内容一模一样。</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2022/02/17/Git/z-commit规范/"><span></span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/02/17/Git/z-commit规范/" rel="bookmark">
        <time class="entry-date published" datetime="2022-02-17T07:30:55.903Z">
          2022-02-17
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="Commitzen"><a href="#Commitzen" class="headerlink" title="Commitzen"></a><code>Commitzen</code></h1><h2 id="安装指南"><a href="#安装指南" class="headerlink" title="安装指南"></a>安装指南</h2><p>安装<code>commitizen</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">全局安装  -g</span></span><br><span class="line">(sudo) npm install -g commitizen</span><br></pre></td></tr></table></figure>

<p>配置</p>
<p>cd到<code>.git</code>所在目录<strong>（初始化）</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">commitizen init cz-conventional-changelog --save --save-exact</span><br></pre></td></tr></table></figure>

<p> 使用</p>
<p><strong>用<code>git cz</code>命令来取代<code>git commit</code></strong></p>
<h2 id="异常情况"><a href="#异常情况" class="headerlink" title="异常情况"></a>异常情况</h2><h3 id="有可能提示你缺少package-json"><a href="#有可能提示你缺少package-json" class="headerlink" title="有可能提示你缺少package.json"></a>有可能提示你缺少<code>package.json</code></h3><p><code>package.json</code>的<a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/twbs/bootstrap/master/package.json">下载地址</a></p>
<h3 id="配置第二个项目"><a href="#配置第二个项目" class="headerlink" title="配置第二个项目"></a>配置第二个项目</h3><p>当我们配置第二个项目的时候我们只需要进入到对应的<code>.git</code>文件夹下，输入如下的命令<code>commitizen init cz-conventional-changelog --force</code><br>我们就可以使用<code>git cz</code>命令了</p>
<h2 id="commitizen详解"><a href="#commitizen详解" class="headerlink" title="commitizen详解"></a>commitizen详解</h2><h3 id="Message-格式"><a href="#Message-格式" class="headerlink" title="Message 格式"></a>Message 格式</h3><p>一般来说，Commit Message 应包含三部分内容：Header、Body、Footer</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br><span class="line">// 空一行</span><br><span class="line">&lt;body&gt;</span><br><span class="line">// 空一行</span><br><span class="line">&lt;footer&gt;12345</span><br></pre></td></tr></table></figure>

<h4 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h4><p>Header部分应只包含一行，包括三个字段：type、scope和subject</p>
<ul>
<li>type type用于说明Commit的类型，包含一下7种类型</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">feat：新功能（feature）</span><br><span class="line">fix：修补bug</span><br><span class="line">docs：文档（documentation）</span><br><span class="line">style： 格式（不影响代码运行的变动）</span><br><span class="line">refactor：重构（即不是新增功能，也不是修改bug的代码变动）</span><br><span class="line">test：增加测试</span><br><span class="line">chore：构建过程或辅助工具的变动1234567</span><br></pre></td></tr></table></figure>

<ul>
<li>scope</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scope用于说明本次Commit所影响的范围，比如controller、user或者README，视项目的不同而不同1</span><br></pre></td></tr></table></figure>

<ul>
<li><p>subject</p>
<p>subject是本次Commit目的的简短描述，一般不要超过50个字符</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">以动词开头，使用第一人称现在时，比如change，而不是changed或changes</span><br><span class="line">第一个字母小写</span><br><span class="line">结尾不加句号（.）123</span><br></pre></td></tr></table></figure>

<h4 id="Body"><a href="#Body" class="headerlink" title="Body"></a>Body</h4><p>Body是对本地提交的一个详细描述，下面是一个示例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">More detailed explanatory text, if necessary.  Wrap it to </span><br><span class="line">about 72 characters or so. </span><br><span class="line"></span><br><span class="line">Further paragraphs come after blank lines.</span><br><span class="line"></span><br><span class="line">- Bullet points are okay, too</span><br><span class="line">- Use a hanging indent1234567</span><br></pre></td></tr></table></figure>

<h4 id="Footer"><a href="#Footer" class="headerlink" title="Footer"></a>Footer</h4><p>Footer只用于两种情况</p>
<ul>
<li>*<strong>不兼容改动*</strong></li>
</ul>
<p>如果当前代码与上一个版本不兼容，则 Footer 部分以BREAKING CHANGE开头，后面是对变动的描述、以及变动理由和迁移方法。</p>
<ul>
<li>*<strong>关闭Issue*</strong></li>
</ul>
<p>如果当前Commit是针对某个Issue的提交，那么久可以在Footer中关闭这个Issue：Closes #234</p>
<h1 id="Commit-message-和-Change-log-编写指南"><a href="#Commit-message-和-Change-log-编写指南" class="headerlink" title="Commit message 和 Change log 编写指南"></a>Commit message 和 Change log 编写指南</h1><p>作者： <a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/">阮一峰</a></p>
<p>日期： <a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2016/01/">2016年1月 6日</a></p>
<p>Git 每次提交代码，都要写 Commit message（提交说明），否则就不允许提交。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git commit -m <span class="string">&quot;hello world&quot;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>上面代码的<code>-m</code>参数，就是用来指定 commit mesage 的。</p>
<p>如果一行不够，可以只执行<code>git commit</code>，就会跳出文本编辑器，让你写多行。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git commit</span><br></pre></td></tr></table></figure>
</blockquote>
<p>但是，一般来说，commit message 应该清晰明了，说明本次提交的目的。</p>
<p>目前，社区有多种 Commit message 的<a target="_blank" rel="noopener" href="https://github.com/ajoslin/conventional-changelog/blob/master/conventions">写法规范</a>。本文介绍<a target="_blank" rel="noopener" href="https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#heading=h.greljkmo14y0">Angular 规范</a>（见上图），这是目前使用最广的写法，比较合理和系统化，并且有配套的工具。</p>
<h2 id="一、Commit-message-的作用"><a href="#一、Commit-message-的作用" class="headerlink" title="一、Commit message 的作用"></a>一、Commit message 的作用</h2><p>格式化的Commit message，有几个好处。</p>
<p><strong>（1）提供更多的历史信息，方便快速浏览。</strong></p>
<p>比如，下面的命令显示上次发布后的变动，每个commit占据一行。你只看行首，就知道某次 commit 的目的。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> &lt;last tag&gt; HEAD --pretty=format:%s</span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>（2）可以过滤某些commit（比如文档改动），便于快速查找信息。</strong></p>
<p>比如，下面的命令仅仅显示本次发布新增加的功能。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> &lt;last release&gt; HEAD --grep feature</span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>（3）可以直接从commit生成Change log。</strong></p>
<p>Change Log 是发布新版本时，用来说明与上一个版本差异的文档，详见后文。</p>
<h2 id="二、Commit-message-的格式"><a href="#二、Commit-message-的格式" class="headerlink" title="二、Commit message 的格式"></a>二、Commit message 的格式</h2><p>每次提交，Commit message 都包括三个部分：Header，Body 和 Footer。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">type</span>&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br><span class="line">// 空一行</span><br><span class="line">&lt;body&gt;</span><br><span class="line">// 空一行</span><br><span class="line">&lt;footer&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>其中，Header 是必需的，Body 和 Footer 可以省略。</p>
<p>不管是哪一个部分，任何一行都不得超过72个字符（或100个字符）。这是为了避免自动换行影响美观。</p>
<h3 id="2-1-Header"><a href="#2-1-Header" class="headerlink" title="2.1 Header"></a>2.1 Header</h3><p>Header部分只有一行，包括三个字段：<code>type</code>（必需）、<code>scope</code>（可选）和<code>subject</code>（必需）。</p>
<p><strong>（1）type</strong></p>
<p><code>type</code>用于说明 commit 的类别，只允许使用下面7个标识。</p>
<blockquote>
<ul>
<li>feat：新功能（feature）</li>
<li>fix：修补bug</li>
<li>docs：文档（documentation）</li>
<li>style： 格式（不影响代码运行的变动）</li>
<li>refactor：重构（即不是新增功能，也不是修改bug的代码变动）</li>
<li>test：增加测试</li>
<li>chore：构建过程或辅助工具的变动</li>
</ul>
</blockquote>
<p>如果<code>type</code>为<code>feat</code>和<code>fix</code>，则该 commit 将肯定出现在 Change log 之中。其他情况（<code>docs</code>、<code>chore</code>、<code>style</code>、<code>refactor</code>、<code>test</code>）由你决定，要不要放入 Change log，建议是不要。</p>
<p><strong>（2）scope</strong></p>
<p><code>scope</code>用于说明 commit 影响的范围，比如数据层、控制层、视图层等等，视项目不同而不同。</p>
<p><strong>（3）subject</strong></p>
<p><code>subject</code>是 commit 目的的简短描述，不超过50个字符。</p>
<blockquote>
<ul>
<li>以动词开头，使用第一人称现在时，比如<code>change</code>，而不是<code>changed</code>或<code>changes</code></li>
<li>第一个字母小写</li>
<li>结尾不加句号（<code>.</code>）</li>
</ul>
</blockquote>
<h3 id="2-2-Body"><a href="#2-2-Body" class="headerlink" title="2.2 Body"></a>2.2 Body</h3><p>Body 部分是对本次 commit 的详细描述，可以分成多行。下面是一个范例。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">More detailed explanatory text, <span class="keyword">if</span> necessary.  Wrap it to </span><br><span class="line">about 72 characters or so. </span><br><span class="line"></span><br><span class="line">Further paragraphs come after blank lines.</span><br><span class="line"></span><br><span class="line">- Bullet points are okay, too</span><br><span class="line">- Use a hanging indent</span><br></pre></td></tr></table></figure>
</blockquote>
<p>有两个注意点。</p>
<p>（1）使用第一人称现在时，比如使用<code>change</code>而不是<code>changed</code>或<code>changes</code>。</p>
<p>（2）应该说明代码变动的动机，以及与以前行为的对比。</p>
<h3 id="2-3-Footer"><a href="#2-3-Footer" class="headerlink" title="2.3 Footer"></a>2.3 Footer</h3><p>Footer 部分只用于两种情况。</p>
<p><strong>（1）不兼容变动</strong></p>
<p>如果当前代码与上一个版本不兼容，则 Footer 部分以<code>BREAKING CHANGE</code>开头，后面是对变动的描述、以及变动理由和迁移方法。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">BREAKING CHANGE: isolate scope bindings definition has changed.</span><br><span class="line"></span><br><span class="line">    To migrate the code follow the example below:</span><br><span class="line"></span><br><span class="line">    Before:</span><br><span class="line"></span><br><span class="line">    scope: &#123;</span><br><span class="line">      myAttr: <span class="string">&#x27;attribute&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    After:</span><br><span class="line"></span><br><span class="line">    scope: &#123;</span><br><span class="line">      myAttr: <span class="string">&#x27;@&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    The removed `inject` wasn<span class="string">&#x27;t generaly useful for directives so there should be no code using it.</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>（2）关闭 Issue</strong></p>
<p>如果当前 commit 针对某个issue，那么可以在 Footer 部分关闭这个 issue 。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Closes <span class="comment">#234</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>也可以一次关闭多个 issue 。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Closes <span class="comment">#123, #245, #992</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="2-4-Revert"><a href="#2-4-Revert" class="headerlink" title="2.4 Revert"></a>2.4 Revert</h3><p>还有一种特殊情况，如果当前 commit 用于撤销以前的 commit，则必须以<code>revert:</code>开头，后面跟着被撤销 Commit 的 Header。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">revert: feat(pencil): add <span class="string">&#x27;graphiteWidth&#x27;</span> option</span><br><span class="line"></span><br><span class="line">This reverts commit 667ecc1654a317a13331b17617d973392f415f02.</span><br></pre></td></tr></table></figure>
</blockquote>
<p>Body部分的格式是固定的，必须写成<code>This reverts commit &lt;hash&gt;.</code>，其中的<code>hash</code>是被撤销 commit 的 SHA 标识符。</p>
<p>如果当前 commit 与被撤销的 commit，在同一个发布（release）里面，那么它们都不会出现在 Change log 里面。如果两者在不同的发布，那么当前 commit，会出现在 Change log 的<code>Reverts</code>小标题下面。</p>
<h2 id="三、Commitizen"><a href="#三、Commitizen" class="headerlink" title="三、Commitizen"></a>三、Commitizen</h2><p><a target="_blank" rel="noopener" href="https://github.com/commitizen/cz-cli">Commitizen</a>是一个撰写合格 Commit message 的工具。</p>
<p>安装命令如下。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g commitizen</span><br></pre></td></tr></table></figure>
</blockquote>
<p>然后，在项目目录里，运行下面的命令，使其支持 Angular 的 Commit message 格式。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ commitizen init cz-conventional-changelog --save --save-exact</span><br></pre></td></tr></table></figure>
</blockquote>
<p>以后，凡是用到<code>git commit</code>命令，一律改为使用<code>git cz</code>。这时，就会出现选项，用来生成符合格式的 Commit message。</p>
<p><img src="https://www.ruanyifeng.com/blogimg/asset/2016/bg2016010605.png" alt="img"></p>
<h2 id="四、validate-commit-msg"><a href="#四、validate-commit-msg" class="headerlink" title="四、validate-commit-msg"></a>四、validate-commit-msg</h2><p><a target="_blank" rel="noopener" href="https://github.com/kentcdodds/validate-commit-msg">validate-commit-msg</a> 用于检查 Node 项目的 Commit message 是否符合格式。</p>
<p>它的安装是手动的。首先，拷贝下面这个<a target="_blank" rel="noopener" href="https://github.com/kentcdodds/validate-commit-msg/blob/master/index.js">JS文件</a>，放入你的代码库。文件名可以取为<code>validate-commit-msg.js</code>。</p>
<p>接着，把这个脚本加入 Git 的 hook。下面是在<code>package.json</code>里面使用 <a target="_blank" rel="noopener" href="http://npm.im/ghooks">ghooks</a>，把这个脚本加为<code>commit-msg</code>时运行。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;config&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;ghooks&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;commit-msg&quot;</span>: <span class="string">&quot;./validate-commit-msg.js&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>然后，每次<code>git commit</code>的时候，这个脚本就会自动检查 Commit message 是否合格。如果不合格，就会报错。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git add -A </span><br><span class="line">$ git commit -m <span class="string">&quot;edit markdown&quot;</span> </span><br><span class="line">INVALID COMMIT MSG: does not match <span class="string">&quot;&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;&quot;</span> ! was: edit markdown</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="五、生成-Change-log"><a href="#五、生成-Change-log" class="headerlink" title="五、生成 Change log"></a>五、生成 Change log</h2><p>如果你的所有 Commit 都符合 Angular 格式，那么发布新版本时， Change log 就可以用脚本自动生成（<a target="_blank" rel="noopener" href="https://github.com/ajoslin/conventional-changelog/blob/master/CHANGELOG.md">例1</a>，<a target="_blank" rel="noopener" href="https://github.com/karma-runner/karma/blob/master/CHANGELOG.md">例2</a>，<a target="_blank" rel="noopener" href="https://github.com/btford/grunt-conventional-changelog/blob/master/CHANGELOG.md">例3</a>）。</p>
<p>生成的文档包括以下三个部分。</p>
<blockquote>
<ul>
<li>New features</li>
<li>Bug fixes</li>
<li>Breaking changes.</li>
</ul>
</blockquote>
<p>每个部分都会罗列相关的 commit ，并且有指向这些 commit 的链接。当然，生成的文档允许手动修改，所以发布前，你还可以添加其他内容。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ajoslin/conventional-changelog">conventional-changelog</a> 就是生成 Change log 的工具，运行下面的命令即可。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g conventional-changelog</span><br><span class="line">$ <span class="built_in">cd</span> my-project</span><br><span class="line">$ conventional-changelog -p angular -i CHANGELOG.md -w</span><br></pre></td></tr></table></figure>
</blockquote>
<p>上面命令不会覆盖以前的 Change log，只会在<code>CHANGELOG.md</code>的头部加上自从上次发布以来的变动。</p>
<p>如果你想生成所有发布的 Change log，要改为运行下面的命令。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ conventional-changelog -p angular -i CHANGELOG.md -w -r 0</span><br></pre></td></tr></table></figure>
</blockquote>
<p>为了方便使用，可以将其写入<code>package.json</code>的<code>scripts</code>字段。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;changelog&quot;</span>: <span class="string">&quot;conventional-changelog -p angular -i CHANGELOG.md -w -r 0&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>以后，直接运行下面的命令即可。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm run changelog</span><br></pre></td></tr></table></figure>
</blockquote>
<p>（完）</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2022/02/17/Git/z-issue/"><span></span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/02/17/Git/z-issue/" rel="bookmark">
        <time class="entry-date published" datetime="2022-02-17T07:30:55.903Z">
          2022-02-17
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p><a target="_blank" rel="noopener" href="https://gitee.com/cnsam2012/banbang-fount-dev/issues/I4SL9H">https://gitee.com/cnsam2012/banbang-fount-dev/issues/I4SL9H</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2022/02/17/Git/3-远程仓库/"><span></span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/02/17/Git/3-远程仓库/" rel="bookmark">
        <time class="entry-date published" datetime="2022-02-17T07:30:55.887Z">
          2022-02-17
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="添加远程库"><a href="#添加远程库" class="headerlink" title="添加远程库"></a>添加远程库</h1><p>生成 <code>ssh key</code> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;youremail@example.com&quot;</span><br></pre></td></tr></table></figure>

<p>在~&#x2F;.ssh中找到密钥对</p>
<p>添加远程库，命名为origin（<code>origin</code>是默认习惯命名）</p>
<blockquote>
<p>若从远程库克隆一个仓库，则该远程库会被命名为origin<br>可以用 <code> git remote -v</code> 查看</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin git@gitee.com:LDBCC/learngit.git</span><br></pre></td></tr></table></figure>



<p>本地库可以在 <code>commit</code> 后，把本地库的<strong>master分支</strong>推送到远程库上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>



<h1 id="删除远程库"><a href="#删除远程库" class="headerlink" title="删除远程库"></a>删除远程库</h1><p>查看远程库的信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git remote -v</span><br><span class="line">origin  git@gitee.com:LDBCC/learngit.git (fetch)</span><br><span class="line">origin  git@gitee.com:LDBCC/learngit.git (push)</span><br></pre></td></tr></table></figure>



<p>根据名字删除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote rm origin</span><br></pre></td></tr></table></figure>



<h1 id="从远程库克隆"><a href="#从远程库克隆" class="headerlink" title="从远程库克隆"></a>从远程库克隆</h1><p>git可以使用多种协议，其中 <code>ssh</code> 最快</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@gitee.com:LDBCC/learngit.git</span><br></pre></td></tr></table></figure>


      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2022/02/17/Git/4-分支/"><span></span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/02/17/Git/4-分支/" rel="bookmark">
        <time class="entry-date published" datetime="2022-02-17T07:30:55.887Z">
          2022-02-17
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <ul>
<li><code>git branch</code> 命令会列出所有分支，当前分支前面会标一个<code>*</code>号</li>
</ul>
<h1 id="创建与合并分支"><a href="#创建与合并分支" class="headerlink" title="创建与合并分支"></a>创建与合并分支</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#创建分支newbranch</span><br><span class="line">git branch newbranch</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#切换至分支newbranch</span><br><span class="line">git checkout newbranch</span><br><span class="line"></span><br><span class="line">#切换分支推荐使用switch</span><br><span class="line">git switch newbranch</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#创建 + 切换分支，一个顶俩</span><br><span class="line">git checkout -b newbranch</span><br><span class="line">#switch也可以</span><br><span class="line">git switch -c newbranch</span><br><span class="line">#注意：这里C大写，可用于强制新建分支，会覆盖此前存在的同名分支</span><br><span class="line">git switch -C newbranch</span><br></pre></td></tr></table></figure>

<p>在该分支上做文件修改并 <code>commit</code> 后，切换回 <code>master</code> 分支</p>
<blockquote>
<p>切换回 <code>master</code> 分支后，刚才修改的内容不见了！</p>
<p>因为那个提交是在 <code>newbranch</code> 分支上，而 <code>master</code> 分支此刻的提交点并没有变</p>
<p>这时就需要<strong>合并分支</strong></p>
</blockquote>
<p>使用 <code>git merge</code> 把 <code>newbranch</code> 的作业成果合并到<strong>当前</strong>（master）分支上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge newbranch</span><br></pre></td></tr></table></figure>

<p>合并后删除（delete）分支</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d newbranch</span><br></pre></td></tr></table></figure>



<h1 id="解决冲突"><a href="#解决冲突" class="headerlink" title="解决冲突"></a>解决冲突</h1><ul>
<li>解决冲突：把Git合并失败的文件<strong>手动编辑</strong>为我们希望的内容，再提交</li>
<li><code>git log --graph</code> 呈现分支合并图</li>
</ul>
<h1 id="分支管理策略"><a href="#分支管理策略" class="headerlink" title="分支管理策略"></a>分支管理策略</h1><h1 id="Bug分支"><a href="#Bug分支" class="headerlink" title="Bug分支"></a>Bug分支</h1><h1 id="Feature分支"><a href="#Feature分支" class="headerlink" title="Feature分支"></a>Feature分支</h1><h1 id="协作"><a href="#协作" class="headerlink" title="协作"></a>协作</h1>
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2022/02/17/Git/2-回溯/"><span></span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/02/17/Git/2-回溯/" rel="bookmark">
        <time class="entry-date published" datetime="2022-02-17T07:30:55.871Z">
          2022-02-17
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <ul>
<li>使用 <code>git status</code> 查看工作区状态</li>
<li>使用 <code>git diff</code> 查看差异</li>
</ul>
<h1 id="版本回退"><a href="#版本回退" class="headerlink" title="版本回退"></a>版本回退</h1><ul>
<li><code>git log</code> （提交历史）保存了 <code>commit</code> 记录</li>
<li><code>git reflog</code> （命令历史）记录了每一次命令</li>
<li>用<code>HEAD</code>表示当前版本</li>
<li><code>git reset</code> 会将所有stage的文件状态，都改变成非stage状</li>
</ul>
<h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a><strong>操作</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#回退往上1个版本</span><br><span class="line">$ git reset --hard HEAD^</span><br><span class="line"></span><br><span class="line">#回退往上100个版本</span><br><span class="line">$ git reset --hard HEAD~100</span><br><span class="line"></span><br><span class="line">#查看每一次命令 前串数字是版本号</span><br><span class="line">$ git reflog</span><br><span class="line">04db4ce (HEAD -&gt; master) HEAD@&#123;0&#125;: reset: moving to HEAD^</span><br><span class="line">076f321 HEAD@&#123;1&#125;: commit: 删掉了text.txt</span><br><span class="line">04db4ce (HEAD -&gt; master) HEAD@&#123;2&#125;: commit: 加了一句有意义的话，减少了一些没用的东西</span><br><span class="line">48e409c HEAD@&#123;3&#125;: commit (initial): 添加了两个测试文件，里边没有什么有意义的东西</span><br><span class="line"></span><br><span class="line">#回退到版本号（commit id）为‘076f321’的版本</span><br><span class="line">$ sudo git reset --hard 076f321</span><br><span class="line">HEAD is now at 076f321 删掉了text.txt</span><br></pre></td></tr></table></figure>







<h1 id="工作区和暂存区"><a href="#工作区和暂存区" class="headerlink" title="工作区和暂存区"></a>工作区和暂存区</h1><p><img src="/img%5Cwd-repo-stage.png" alt="image-wd-repo-stage"></p>
<ul>
<li><strong>工作区（Working Directory）</strong>：<code>learngit</code> 文件夹就是一个工作区。</li>
<li><strong>版本库（Repository）</strong>：工作区有个隐藏目录 .git ，这个不算工作区，而是 Git 的版本库。</li>
<li>版本库里面的 <strong>index(stage)</strong> 文件叫<strong>暂存区</strong>，还有Git为我们自动创建的第一个分支 master ，以及指向 master 的一个指针叫做 HEAD。</li>
<li><code>git add</code>命令实际上就是把要提交的所有修改放到<strong>暂存区（Stage）</strong></li>
<li>然后，执行<code>git commit</code>就可以一次性把<strong>Stage</strong>的所有修改提交到<strong>分支</strong><ul>
<li>（我们现在只有唯一一个分支 master，所以现在就是往 master 分支上提交更改）</li>
</ul>
</li>
</ul>
<blockquote>
<p><code>git status</code>:</p>
<p>作两次对比，工作区 vs 暂存区 以及 暂存区 vs 仓库，并将两次对比的结果显示在输出中。</p>
<p>哪个对比没差别，就不显示。两个对比都没差别，就显示working tree clean。</p>
<p><code>git diff</code>：</p>
<ol>
<li>git diff：是查看working tree与index的差别的。</li>
<li>git diff –cached：是查看index与repository的差别的。</li>
<li>git diff HEAD：是查看working tree和repository的差别的。其中：HEAD代表的是最近的一次commit的信息。</li>
</ol>
</blockquote>
<h1 id="管理与撤销修改"><a href="#管理与撤销修改" class="headerlink" title="管理与撤销修改"></a>管理与撤销修改</h1><ul>
<li><p>git管理你的<strong>修改行为</strong></p>
</li>
<li><p>对于<strong>同一行发生的内容变化</strong>，git理解为先删除修改前的此行、后添加修改后的此行</p>
<ul>
<li><blockquote>
<p> （机翻，原文寻无）</p>
<p> Unix历史上有一个所有人类可读的文本文件都以换行符结尾的约定。当时，这避免了在显示或连接文本文件时进行额外的处理，并避免了将文本文件与包含其他类型数据的文件(例如原始二进制数据，这是人类无法读取的)进行不同的处理。</p>
<p> 由于这种惯例，那个时代的许多工具都期望换行结束，包括文本编辑器、差异化工具和其他文本处理工具。Mac OS X是在BSD Unix上构建的，Linux是为与Unix兼容而开发的，因此两个操作系统都继承了相同的约定、行为和工具。</p>
<p> Windows并没有开发成与Unix兼容，所以它没有相同的约定，而且大多数Windows软件都会处理得很好，没有后继的换行符。但是，由于Git首先是为Linux开发的，并且许多开源软件都建立在与Unix兼容的系统上，如Linux、Mac OS X、FreeBSD等，因此大多数开源社区及其工具(包括编程语言)继续遵循这些约定。</p>
<p> 有一些技术原因在1971年是有意义的，但在这个时代，它主要是传统的，并保持与现有工具的兼容性。</p>
</blockquote>
</li>
</ul>
</li>
<li><p><code>git restore</code> 是git 2.23版本新增的命令，用来代替身兼数职的<code>git checkout</code></p>
</li>
<li><p>从暂存区恢复工作区，</p>
<p><code>git resotre --worktree readme.txt</code></p>
</li>
<li><p>从master恢复暂存区 </p>
<p><code>git restore --staged readme.txt</code></p>
</li>
<li><p>从master同时恢复工作区和暂存区</p>
<p><code>git restore --source=HEAD --staged --worktree readme.txt</code></p>
</li>
</ul>
<h1 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h1><ul>
<li><p>手动删除文件，然后使用 <code>git rm &lt;file&gt;</code> 和 <code>git add&lt;file&gt;</code> 效果是一样的</p>
</li>
<li><p>从来没有被添加到版本库就被删除的文件，是无法恢复的！</p>
</li>
</ul>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>




<nav class="pagination">
  
  
</nav>
    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2022 John Doe
    
  </p>
</footer>
    
    
  </div>
</div>
</body>
</html>